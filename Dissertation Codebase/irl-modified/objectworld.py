"""
Implements the objectworld MDP described in Levine et al. 2011.

Matthew Alger, 2015
matthew.alger@anu.edu.au
"""

import math
from itertools import product

import numpy as np
import numpy.random as rn

from gridworld import Gridworld

class OWObject(object):
    """
    Object in objectworld.
    """

    def __init__(self, inner_colour, outer_colour):
        """
        inner_colour: Inner colour of object. int.
        outer_colour: Outer colour of object. int.
        -> OWObject
        """

        self.inner_colour = inner_colour
        self.outer_colour = outer_colour

    def __str__(self):
        """
        A string representation of this object.

        -> __str__
        """

        return "<OWObject (In: {}) (Out: {})>".format(self.inner_colour,
                                                      self.outer_colour)

class Objectworld(Gridworld):
    """
    Objectworld MDP.
    """

    def __init__(self, grid_size, n_objects, n_colours, wind, discount):
        """
        grid_size: Grid size. int.
        n_objects: Number of objects in the world. int.
        n_colours: Number of colours to colour objects with. int.
        wind: Chance of moving randomly. float.
        discount: MDP discount. float.
        -> Objectworld
        """

        super(Objectworld,self).__init__(grid_size, wind, discount)

        self.actions = ((1, 0), (0, 1), (-1, 0), (0, -1), (0, 0))
        self.n_actions = len(self.actions)
        self.n_objects = n_objects
        self.n_colours = n_colours

        # Generate objects.
        self.objects = {}
        for _ in range(self.n_objects):
            obj = OWObject(rn.randint(self.n_colours),
                           rn.randint(self.n_colours))

            while True:
                x = rn.randint(self.grid_size)
                y = rn.randint(self.grid_size)

                if (x, y) not in self.objects:
                    break

            self.objects[x, y] = obj

        # Preconstruct the transition probability array.
        self.transition_probability = np.array(
            [[[self._transition_probability(i, j, k)
               for k in range(self.n_states)]
              for j in range(self.n_actions)]
             for i in range(self.n_states)])

    def feature_vector(self, i, discrete=True):
        """
        Get the feature vector associated with a state integer.

        i: State int.
        discrete: Whether the feature vectors should be discrete (default True).
            bool.
        -> Feature vector.
        """

        sx, sy = self.int_to_point(i)

        nearest_inner = {}  # colour: distance
        nearest_outer = {}  # colour: distance

        for y in range(self.grid_size):
            for x in range(self.grid_size):
                if (x, y) in self.objects:
                    dist = math.hypot((x - sx), (y - sy))
                    obj = self.objects[x, y]
                    if obj.inner_colour in nearest_inner:
                        if dist < nearest_inner[obj.inner_colour]:
                            nearest_inner[obj.inner_colour] = dist
                    else:
                        nearest_inner[obj.inner_colour] = dist
                    if obj.outer_colour in nearest_outer:
                        if dist < nearest_outer[obj.outer_colour]:
                            nearest_outer[obj.outer_colour] = dist
                    else:
                        nearest_outer[obj.outer_colour] = dist

        # Need to ensure that all colours are represented.
        for c in range(self.n_colours):
            if c not in nearest_inner:
                nearest_inner[c] = 0
            if c not in nearest_outer:
                nearest_outer[c] = 0

        if discrete:
            state = np.zeros((2*self.n_colours*self.grid_size,))
            i = 0
            for c in range(self.n_colours):
                for d in range(1, self.grid_size+1):
                    if nearest_inner[c] < d:
                        state[i] = 1
                    i += 1
                    if nearest_outer[c] < d:
                        state[i] = 1
                    i += 1
            assert i == 2*self.n_colours*self.grid_size
            assert (state >= 0).all()
        else:
            # Continuous features.
            state = np.zeros((2*self.n_colours))
            i = 0
            for c in range(self.n_colours):
                state[i] = nearest_inner[c]
                i += 1
                state[i] = nearest_outer[c]
                i += 1

        return state

    def feature_matrix(self, discrete=True):
        """
        Get the feature matrix for this objectworld.

        discrete: Whether the feature vectors should be discrete (default True).
            bool.
        -> NumPy array with shape (n_states, n_states).
        """
        return np.array([self.feature_vector(i, discrete)
                         for i in range(self.n_states)])

    def reward(self, state_int):
        """
        Get the reward for a state int.

        state_int: State int.
        -> reward float
        """

        x, y = self.int_to_point(state_int)

        near_c0 = False
        near_c1 = False
        for (dx, dy) in product(range(-3, 4), range(-3, 4)):
            if 0 <= x + dx < self.grid_size and 0 <= y + dy < self.grid_size:
                if (abs(dx) + abs(dy) <= 3 and
                        (x+dx, y+dy) in self.objects and
                        self.objects[x+dx, y+dy].outer_colour == 0):
                    near_c0 = True
                if (abs(dx) + abs(dy) <= 2 and
                        (x+dx, y+dy) in self.objects and
                        self.objects[x+dx, y+dy].outer_colour == 1):
                    near_c1 = True

        if near_c0 and near_c1:
            return 1
        if near_c0:
            return -1
        return 0

    def generate_trajectories(self, n_trajectories, trajectory_length, policy):
        """
        Generate n_trajectories trajectories with length trajectory_length.

        n_trajectories: Number of trajectories. int.
        trajectory_length: Length of an episode. int.
        policy: Map from state integers to action integers.
        -> [[(state int, action int, reward float)]]
        """

        return super(Objectworld,self).generate_trajectories(n_trajectories, trajectory_length,
                                             policy,
                                             True)

    def optimal_policy(self, state_int):
        raise NotImplementedError(
            "Optimal policy is not implemented for Objectworld.")
    def optimal_policy_deterministic(self, state_int):
        raise NotImplementedError(
            "Optimal policy is not implemented for Objectworld.")
        
    def my_generate_trajectories1(self, policy,random_start=False):
        traj=[
            ########################################Paras Starts ######################################
            [68,69,68,67,66,56,56,56,56],
            [82,72,72,72,72,72,72,72,72],
            [74,64,63,63,63,63,63,63,63],
            [76,86,85,85,85,85,85,85,85],
            [1,2,12,12,12,12,12,12,12],
            [81,71,72,72,72,72,72,72,72],
            [35,45,55,56,56,56,56,56,56],
            [14,15,16,16,16,16,16,16,16],
            [17,16,16,16,16,16,16,16,16],
            [47,57,56,56,56,56,56,56,56],
            [11,12,12,12,12,12,12,12,12],
            [38,28,27,27,27,27,27,27,27],
            [98,88,87,97,87,86,85,85,85],
            [81,81,71,72,72,72,72,72,72],
            [10,10,11,21,21,22,22,22,22],
            [36,26,27,27,27,27,27,27,27],
            [97,87,97,96,86,85,85,85,85],
            [7,6,16,16,16,16,16,16,16],
            [22,22,22,22,22,22,22,22,22],
            [8,7,6,16,16,16,16,16,16],
            [72,72,72,72,72,72,72,72,72],
            [84,85,85,85,85,85,85,85,85],
            [42,43,53,63,63,63,63,63,63],
            [51,52,53,52,53,63,63,63,63],
            [75,75,85,85,85,85,85,85,85],
            [87,86,85,85,85,85,85,85,85],
            [3,2,12,12,12,12,12,12,12],
            [66,56,56,56,56,56,56,56,56],
            [71,72,72,72,72,72,72,72,72],
            [29,19,18,17,16,16,16,16,16],
            [11,12,12,12,12,12,12,12,12],
            [67,66,56,56,56,56,56,56,56],
            [39,29,19,18,17,16,16,16,16],
            [66,66,56,56,56,56,56,56,56],
            [34,34,35,45,55,56,56,56,56],
            [27,27,27,27,27,27,27,27,27],
            [30,40,41,42,32,22,22,22,22],
            [24,14,24,25,15,16,16,16,16],
            [96,97,87,86,85,85,85,85,85],
            [38,28,27,27,27,27,27,27,27],
            [86,85,85,85,85,85,85,85,85],
            [81,71,72,72,72,72,72,72,72],
            [60,61,62,63,63,63,63,63,63],
            [85,85,85,85,85,85,85,85,85],
            [90,80,70,60,61,62,72,72,72],
            [36,36,26,16,16,16,16,16,16],
            [32,32,22,22,22,22,22,22,22],
            [29,19,18,8,7,6,16,16,16],
            [9,8,7,6,16,16,16,16,16],
            [3,2,12,12,12,12,12,12,12],
            [47,48,58,57,56,56,56,56,56],
            [25,15,25,15,16,16,16,16,16],
            [90,90,80,70,60,70,60,61,62],
            [81,71,72,72,72,72,72,72,72],
            [67,67,66,56,56,56,56,56,56],
            [97,87,86,85,85,85,85,85,85],
            [19,18,17,16,16,16,16,16,16],
            [25,15,16,16,16,16,16,16,16],
            [45,46,56,56,56,56,56,56,56],
            [40,50,60,61,62,63,63,63,63],
            [52,53,63,63,63,63,63,63,63],
            [67,66,56,56,56,56,56,56,56],
            [81,71,72,72,72,72,72,72,72],
            [60,61,62,63,63,63,63,63,63],
            [21,21,21,21,21,21,21,21,21],
            [15,16,16,16,16,16,16,16,16],
            [43,53,63,63,63,63,63,63,63],
            [33,43,53,63,63,63,63,63,63],
            [57,56,56,56,56,56,56,56,56],
            [15,16,16,16,16,16,16,16,16],
            [48,58,57,56,56,56,56,56,56],
            [79,89,88,87,86,85,85,85,85],
            [14,15,16,16,16,16,16,16,16],
            [59,69,68,67,66,56,56,56,56],
            [72,72,72,72,72,72,72,72,72],
            [36,46,56,56,56,56,56,56,56],
            [47,47,57,56,56,56,56,56,56],
            [17,7,6,16,16,16,16,16,16],
            [54,53,63,63,63,63,63,63,63],
            [46,46,56,56,56,56,56,56,56],
            [58,57,56,56,56,56,56,56,56],
            [62,63,63,63,63,63,63,63,63],
            [9,9,8,7,6,16,16,16,16],
            [36,26,16,16,16,16,16,16,16],
            [90,90,80,70,60,61,62,63,63],
            [36,26,16,16,16,16,16,16,16],
            [10,11,12,12,12,12,12,12,12],
            [44,54,44,54,53,63,63,63,63],
            [39,39,49,59,58,68,67,66,56],
            [94,94,94,94,94,94,94,94,94],
            [20,21,21,21,21,21,21,21,21],
            [14,15,16,16,16,16,16,16,16],
            [19,18,17,16,16,16,16,16,16],
            [58,57,56,56,56,56,56,56,56],
            [36,26,16,16,16,16,16,16,16],
            [9,8,7,6,16,16,16,16,16],
            [98,98,97,96,86,85,85,85,85],
            [56,56,56,56,56,56,56,56,56],
            [40,50,60,61,62,63,63,63,63],
            [32,32,22,22,22,22,22,22,22],
            [72,72,72,72,72,72,72,72,72],
            [51,52,53,63,63,63,63,63,63],
            [90,80,70,60,61,62,63,63,63],
            [31,31,21,21,22,22,22,22,22],
            [88,88,87,97,96,86,85,85,85],
            [92,91,90,90,80,70,60,61,51],
            [96,95,94,94,94,94,94,94,94],
            [3,2,12,12,12,12,12,12,12],
            [9,8,8,7,6,16,16,16,16],
            [25,15,16,16,16,16,16,16,16],
            [77,76,86,85,85,85,85,85,85],
            [97,87,86,85,85,85,85,85,85],
            [52,42,52,53,63,63,63,63,63],
            [48,58,57,56,56,56,56,56,56],
            [42,52,53,63,63,63,63,63,63],
            [39,49,59,58,57,56,56,56,56],
            [84,85,85,85,85,85,85,85,85],
            [47,57,56,56,56,56,56,56,56],
            [88,87,86,85,85,85,85,85,85],
            [71,71,72,72,72,72,72,72,72],
            [66,56,56,56,56,56,56,56,56],
            [56,56,56,56,56,56,56,56,56],
            ########################################Paras ends ######################################
            
            ########################################Aditya Starts ######################################
            [10,10,11,21,21,21,21,21,21],
            [55,56,56,56,56,56,56,56,56],
            [26,16,16,16,16,16,16,16,16],
            [51,51,41,51,52,53,63,63,63],
            [60,60,60,61,62,63,63,63,63],
            [47,47,57,56,56,56,56,56,56],
            [10,10,11,12,12,12,12,12,12],
            [33,43,53,63,63,63,63,63,63],
            [49,49,39,38,28,27,27,27,27],
            [86,86,85,85,85,85,85,85,85],
            [90,80,70,71,72,72,72,72,72],
            [84,84,85,85,85,85,85,85,85],
            [76,66,56,56,56,56,56,56,56],
            [80,80,70,60,50,40,30,31,21],
            [92,92,92,92,92,93,94,94,94],
            [13,13,23,22,22,22,22,22,22],
            [83,83,93,94,94,94,94,94,94],
            [89,89,89,88,87,86,85,85,85],
            [54,54,64,63,63,63,63,63,63],
            [41,41,42,32,33,23,22,22,22],
            [33,33,34,44,54,55,56,56,56],
            [55,55,56,56,56,56,56,56,56],
            [78,77,76,86,85,85,85,85,85],
            [0,0,1,2,12,12,12,12,12],
            [81,81,71,72,72,72,72,72,72],
            [47,47,57,56,56,56,56,56,56],
            [3,13,12,12,12,12,12,12,12],
            [56,56,56,56,56,56,56,56,56],
            [1,11,21,21,21,21,21,21,21],
            [64,64,63,63,63,63,63,63,63],
            [27,27,17,16,16,16,16,16,16],
            [84,84,94,94,94,94,94,94,94],
            [83,83,84,94,94,94,94,94,94],
            [64,63,63,63,63,63,63,63,63],
            [20,20,21,22,22,22,22,22,22],
            [28,28,27,27,27,27,27,27,27],
            [92,92,93,94,94,94,94,94,94],
            [54,54,53,63,62,72,71,71,71],
            [40,40,40,41,42,43,53,63,63],
            [91,91,81,71,72,72,72,72,72],
            [8,9,19,29,19,18,8,7,6],
            [27,27,27,27,27,17,16,16,16],
            [68,68,58,57,56,56,56,56,56],
            [9,8,7,6,16,16,16,16,16],
            [32,32,22,22,22,22,22,22,22],
            [81,81,91,81,71,72,72,72,72],
            [78,78,78,77,76,86,85,85,85],
            [33,32,42,52,53,63,63,63,63],
            [45,55,56,56,56,56,56,56,56],
            [66,76,86,85,85,85,85,85,85],
            [60,61,62,63,63,63,63,63,63],
            [79,79,69,59,69,68,67,57,56],
            [43,43,43,43,43,42,52,62,63],
            [62,62,62,72,72,72,72,72,72],
            [5,15,16,16,16,16,16,16,16],
            [83,73,63,63,63,63,63,63,63],
            [56,56,55,65,64,63,63,63,63],
            [38,38,37,47,57,56,56,56,56],
            [32,32,32,22,22,22,22,22,22],
            [26,36,35,25,15,16,16,16,16],
            [4,4,14,13,12,12,12,12,12],
            [78,78,77,76,75,85,85,85,85],
            [0,0,10,11,12,12,12,12,12],
            [5,5,15,5,6,16,16,16,16],
            [13,13,12,12,12,12,12,12,12],
            [39,29,28,27,27,27,27,27,27],
            [38,38,28,18,17,16,16,16,16],
            [21,21,22,22,22,22,22,22,22],
            [1,1,11,12,12,12,12,12,12],
            [55,55,65,75,74,64,63,63,63],
            [19,19,29,28,27,27,27,27,27],
            [87,87,86,85,85,85,85,85,85],
            [12,12,12,12,12,12,12,12,12],
            [43,43,53,63,63,63,63,63,63],
            [81,81,82,83,84,74,75,85,85],
            [41,41,41,41,42,43,53,63,63],
            [1,1,2,12,12,12,12,12,12],
            [21,21,22,22,22,22,22,22,22],
            [11,11,11,12,12,12,12,12,12],
            [74,74,75,85,85,85,85,85,85],
            [46,56,56,56,56,56,56,56,56],
            [28,28,18,17,16,16,16,16,16],
            [29,29,28,27,27,27,27,27,27],
            [78,77,76,86,85,85,85,85,85],
            [84,84,74,64,63,63,63,63,63],
            [39,39,38,37,47,57,56,56,56],
            [20,20,30,30,31,21,21,21,21],
            [22,22,22,22,22,22,22,22,22],
            [53,53,43,53,63,63,63,63,63],
            [80,80,70,71,72,72,72,72,72],
            [58,58,68,78,68,67,77,87,86],
            [72,72,72,72,62,63,63,63,63],
            [91,91,92,93,83,84,85,85,85],
            [82,82,72,72,72,72,72,72,72],
            [24,24,23,22,22,22,22,22,22],
            [9,9,8,7,6,16,16,16,16],
            [92,92,92,92,92,93,94,94,94],
            [67,67,66,76,86,85,85,85,85],
            [41,41,42,52,62,72,72,72,72],
            [45,44,54,64,63,63,63,63,63],
            [74,74,64,63,63,63,63,63,63],
            [85,85,85,85,85,85,85,85,85],
            [45,45,55,56,56,56,56,56,56],
            [12,12,13,12,12,12,12,12,12],
            [51,51,61,71,72,72,72,72,72],
            [20,20,21,21,21,21,21,21,21],
            [85,85,86,85,85,85,85,85,85],
            [64,64,63,63,63,63,63,63,63],
            [74,74,73,72,72,72,72,72,72],
            [26,26,36,46,56,56,56,56,56],
            [27,27,26,16,16,16,16,16,16],
            [49,49,49,59,69,79,69,68,67],
            [16,16,16,16,16,16,16,16,16],
            [9,9,19,29,28,27,27,27,27],
            [27,27,27,27,27,27,27,27,27],
            [8,8,7,17,27,27,27,27,27],
            [63,63,63,63,63,63,63,63,63],
            [75,85,85,85,85,85,85,85,85],
            [37,37,36,35,36,46,56,56,56],
            [40,40,50,51,52,53,63,63,63],
            [78,78,77,76,66,76,86,85,85],
            [38,38,37,27,27,27,27,27,27],
            [2,2,12,12,12,12,12,12,12],
            [34,33,32,22,22,22,22,22,22],
            [70,70,60,61,62,63,63,63,63],
            [35,35,34,33,32,22,22,22,22],
            [7,7,6,16,16,16,16,16,16],
            [71,71,72,72,72,72,72,72,72],
            ########################################Aditya ends ######################################
            
            
            
            ###################################################################################################
            ########################################Green Ends and Red Starts ######################################
            ###################################################################################################
        ]
        trajectories = []
        n_trajectories=len(traj)
        for i in range(n_trajectories):
            trajectory = []
            #for j in range(trajectory_length):
            for j in range(len(traj[i])):
                trajectory.append((traj[i][j], 0, 0))
            
            trajectories.append(trajectory)
        return np.array(trajectories)
    
    def my_generate_trajectories2(self, policy,random_start=False):
        traj=[
            [0,0,0,0,0,0,0,0,0],
            [28,38,38,38,38,38,38,38,38],
            [33,34,34,34,34,34,34,34,34],
            [25,25,25,25,25,25,25,25,25],
            [38,38,38,38,38,38,38,38,38],
            [55,45,45,45,45,45,45,45,45],
            [72,72,82,82,82,82,82,82,82],
            [71,81,81,81,81,81,81,81,81],
            [97,87,77,76,75,74,74,74,74],
            [77,77,76,75,74,74,74,74,74],
            [40,40,30,31,31,31,31,31,31],
            [11,11,11,11,11,11,11,11,11],
            [88,88,78,77,76,75,74,74,74],
            [4,4,14,13,13,13,13,13,13],
            [7,17,18,28,27,37,37,37,37],
            [59,59,49,48,47,47,47,47,47],
            [36,36,36,36,36,36,36,36,36],
            [75,75,75,74,74,74,74,74,74],
            [83,83,83,83,83,83,83,83,83],
            [11,11,11,11,11,11,11,11,11],
            [95,96,86,76,75,74,74,74,74],
            [94,94,84,84,84,84,84,84,84],
            [93,93,93,93,93,93,93,93,93],
            [45,45,45,45,45,45,45,45,45],
            [60,70,80,81,81,81,81,81,81],
            [78,78,78,77,76,86,76,75,74],
            [19,19,18,28,27,37,37,37,37],
            [50,50,50,50,40,30,20,20,20],
            [32,32,31,31,31,31,31,31,31],
            [44,44,45,45,45,45,45,45,45],
            [80,80,81,82,82,82,82,82,82],
            [70,70,70,70,70,70,70,80,81],
            [63,63,63,73,73,73,73,73,73],
            [62,61,71,81,81,81,81,81,81],
            [48,48,47,47,47,47,47,47,47],
            [29,39,38,38,38,38,38,38,38],
            [93,93,93,93,93,93,93,93,93],
            [61,61,60,70,80,81,81,81,81],
            [21,11,11,11,11,11,11,11,11],
            [1,1,1,1,1,1,1,1,1],
            [82,82,82,82,82,82,82,82,82],
            [15,14,24,25,25,25,25,25,25],
            [0,0,0,0,0,0,0,0,0],
            [39,38,38,38,38,38,38,38,38],
            [48,38,38,38,38,38,38,38,38],
            [67,66,67,68,58,48,38,38,38],
            [60,60,60,70,80,90,91,81,81],
            [81,81,81,81,81,81,81,81,81],
            [76,75,74,74,74,74,74,74,74],
            [16,16,17,18,28,38,38,38,38],
            [20,20,20,20,20,20,20,20,20],
            [9,19,29,39,38,38,38,38,38],
            [1,1,1,1,1,1,1,1,1],
            [83,83,83,83,83,83,83,83,83],
            [88,78,68,58,48,38,38,38,38],
            [2,2,2,2,2,2,2,2,2],
            [86,76,75,74,74,74,74,74,74],
            [70,80,81,81,81,81,81,81,81],
            [97,87,77,76,75,74,74,74,74],
            [36,36,36,36,36,36,36,36,36],
            [14,24,25,25,25,25,25,25,25],
            [55,45,45,45,45,45,45,45,45],
            [95,96,95,96,86,76,75,74,74],
            [80,80,80,80,81,81,81,81,81],
            [80,90,91,92,92,92,92,92,92],
            [59,59,58,48,47,47,47,47,47],
            [81,81,81,81,81,81,81,81,81],
            [6,6,5,15,25,25,25,25,25],
            [92,92,92,92,92,92,92,92,92],
            [21,31,31,31,31,31,31,31,31],
            [37,37,37,37,37,37,37,37,37],
            [53,43,44,34,34,34,34,34,34],
            [69,59,49,48,58,48,38,38,38],
            [24,24,25,25,25,25,25,25,25],
            [86,76,86,76,75,65,64,74,74],
            [67,57,47,47,47,47,47,47,47],
            [85,84,84,84,84,84,84,84,84],
            [84,84,84,84,84,84,84,84,84],
            [3,2,2,2,2,2,2,2,2],
            [13,13,13,13,13,13,13,13,13],
            [7,7,8,18,28,38,38,38,38],
            [12,12,11,11,11,11,11,11,11],
            [85,84,84,84,84,84,84,84,84],
            [62,61,71,81,81,81,81,81,81],
            [96,96,86,76,75,74,74,74,74],
            [19,29,39,38,38,38,38,38,38],
            [24,25,25,25,25,25,25,25,25],
            [39,38,37,37,37,37,37,37,37],
            [98,98,88,78,77,76,75,74,74],
            [88,88,78,77,76,75,74,74,74],
            [91,81,81,81,81,81,81,81,81],
            [4,4,3,2,2,2,2,2,2],
            [84,84,84,84,84,84,84,84,84],
            [17,18,19,29,39,38,38,38,38],
            [8,8,18,28,38,38,38,38,38],
            [35,35,35,35,35,35,35,35,35],
            [85,75,74,74,74,74,74,74,74],
            [62,62,61,60,70,80,81,81,81],
            [99,99,99,89,79,78,68,69,59],
            [83,83,83,83,83,83,83,83,83],
            [49,49,48,38,38,38,38,38,38],
            [56,55,45,45,45,45,45,45,45],
            [57,47,47,47,47,47,47,47,47],
            [36,36,36,36,36,36,36,36,36],
            [4,4,14,13,13,13,13,13,13],
            [48,48,47,47,47,47,47,47,47],
            [59,49,48,47,47,47,47,47,47],
            [69,69,59,58,48,58,58,48,38],
            [95,95,96,86,76,75,74,74,74],
            [10,10,10,10,10,10,10,10,10],
            [47,47,47,47,47,47,47,47,47],
            [25,25,25,25,25,25,25,25,25],
            [4,3,2,2,2,2,2,2,2],
            [80,80,81,81,81,81,81,81,81],
            [95,96,97,87,77,76,75,74,74],
            [82,82,82,82,82,82,82,82,82],
            [61,71,81,81,81,81,81,81,81],
            [96,96,86,85,75,74,74,74,74],
            [54,54,64,74,74,74,74,74,74],
            [49,39,38,38,38,38,38,38,38],
            [35,35,35,35,35,35,35,35,35],
            [42,42,43,33,34,34,34,34,34],
            [83,83,83,83,83,83,83,83,83],
            [34,34,34,34,34,34,34,34,34],
            [36,36,36,36,36,36,36,36,36],
            [41,31,31,31,31,31,31,31,31],
            [3,2,2,2,2,2,2,2,2],
            [16,26,26,26,26,26,26,26,26],
            [46,46,46,46,46,46,46,46,46],
            [24,24,25,25,25,25,25,25,25],
            [10,10,10,10,10,10,10,10,10],
            [91,91,92,92,92,92,92,92,92],
            [21,20,20,20,20,20,20,20,20],
            [1,1,1,1,1,1,1,1,1],
            [34,34,34,34,34,34,34,34,34],
            [82,82,82,82,82,82,82,82,82],
            [19,19,29,39,38,38,38,38,38],
            [35,35,35,35,35,35,35,35,35],
            [90,91,92,92,92,92,92,92,92],
            [80,80,81,81,81,81,81,81,81],
            [56,46,36,36,36,36,36,36,36],
            [81,81,81,81,81,81,81,81,81],
            [50,50,60,70,80,81,81,81,81],
            [74,74,74,74,74,74,74,74,74],
            [36,36,36,36,36,36,36,36,36],
            [30,20,20,20,20,20,20,20,20],
            [92,92,92,92,92,92,92,92,92],
            [82,82,82,82,82,82,82,82,82],
            [31,31,31,31,31,31,31,31,31],
            [63,62,61,71,81,81,81,81,81],
            [59,49,39,38,38,38,38,38,38],
            [56,46,46,46,46,46,46,46,46],
            [41,31,31,31,31,31,31,31,31],
            [63,73,73,73,73,73,73,73,73],
            [6,6,6,5,15,25,25,25,25],
            [75,74,74,74,74,74,74,74,74],
            [73,73,73,73,73,73,73,73,73],
            [43,44,34,34,34,34,34,34,34],
            [29,39,38,38,38,38,38,38,38],
            [26,26,26,26,26,26,26,26,26],
            [68,58,48,47,47,47,47,47,47],
            [88,78,68,58,48,38,38,38,38],
            [33,34,34,34,34,34,34,34,34],
            [84,84,84,84,84,84,84,84,84],
            [11,11,11,11,11,11,11,11,11],
            [22,22,23,13,3,3,2,2,2],
            [46,46,46,46,46,46,46,46,46],
            [30,20,20,20,20,20,20,20,20],
            [2,2,2,2,2,2,2,2,2],
            [24,24,34,34,34,34,34,34,34],
            [62,62,61,71,81,81,81,81,81],
            [65,75,65,75,74,74,74,74,74],
            [16,16,26,26,26,26,26,26,26],
            [38,38,38,38,38,38,38,38,38],
            [84,84,84,84,84,84,84,84,84],
            [36,36,36,36,36,36,36,36,36],
            [64,74,74,74,74,74,74,74,74],
            [98,98,88,78,77,76,75,74,74],
            [79,89,88,87,86,76,75,74,74],
            [68,58,48,38,38,38,38,38,38],
            [38,38,38,38,38,38,38,38,38],
            [55,54,44,45,46,46,46,46,46],
            [57,47,47,47,47,47,47,47,47],
            [75,75,74,74,74,74,74,74,74],
            [43,43,33,34,34,34,34,34,34],
            [30,30,20,20,20,20,20,20,20],
            [15,16,26,26,26,26,26,26,26],
            [53,54,55,45,45,45,45,45,45],
            [44,44,45,45,45,45,45,45,45],
            [31,31,31,31,31,31,31,31,31],
            [20,20,20,20,20,20,20,20,20],
            [42,32,31,31,31,31,31,31,31],
            [50,40,41,31,31,31,31,31,31],
            [40,40,30,31,31,31,31,31,31],
            [94,94,93,93,93,93,93,93,93],
            [69,59,49,39,38,38,38,38,38],
            [60,60,50,40,41,31,31,31,31],
            [92,92,92,92,92,92,92,92,92],
            [38,38,38,38,38,38,38,38,38],
            [15,25,25,25,25,25,25,25,25],
            [89,79,69,59,58,48,38,38,38],
            [73,73,73,73,73,73,73,73,73],
            [62,61,71,81,81,81,81,81,81],
            [16,26,26,26,26,26,26,26,26],
            [99,89,79,78,77,76,75,74,74],
            [92,92,92,92,92,92,92,92,92],
            [39,38,38,38,38,38,38,38,38],
            [95,96,86,85,75,74,74,74,74],
            [31,31,31,31,31,31,31,31,31],
            [86,86,76,75,74,74,74,74,74],
            [11,11,11,11,11,11,11,11,11],
            [1,1,1,1,1,1,1,1,1],
            [49,39,38,38,38,38,38,38,38],
            [1,1,1,1,1,1,1,1,1],
            [58,58,58,48,47,47,47,47,47],
            [45,45,45,45,45,45,45,45,45],
            [88,78,77,76,75,74,74,74,74],
            [22,22,32,31,31,31,31,31,31],
            [44,44,34,24,34,34,34,34,34],
            [84,84,84,84,84,84,84,84,84],
            [68,68,58,48,47,47,47,47,47],
            [26,26,26,26,26,26,26,26,26],
            [10,10,10,10,10,10,10,10,10],
            [92,92,92,92,92,92,92,92,92],
            [23,23,13,13,13,13,13,13,13],
            [69,59,49,39,38,38,38,38,38],
            [63,63,62,61,71,81,81,81,81],
            [2,2,2,2,2,2,2,2,2],
            [78,68,58,48,38,38,38,38,38],
            [19,29,39,38,38,38,38,38,38],
            [29,39,38,38,38,38,38,38,38],
            [35,35,35,35,35,35,35,35,35],
            [95,95,96,97,87,86,76,66,65],
            [25,25,25,25,25,25,25,25,25],
            [47,47,47,47,47,47,47,47,47],
            [52,51,61,71,72,82,82,82,82],
            [54,54,54,64,74,74,74,74,74],
            [66,66,66,66,67,57,58,48,47],
            [74,74,74,74,74,74,74,74,74],
            [53,54,64,74,74,74,74,74,74],
            [78,78,77,76,75,74,74,74,74],
            [0,0,0,0,0,0,0,0,0],
            [7,8,18,28,38,38,38,38,38],
            [48,48,48,48,38,38,38,38,38],
            [24,24,25,25,25,25,25,25,25],
            [8,8,18,19,29,39,38,38,38],
            [86,86,87,88,78,77,76,75,74],
            [96,96,86,76,75,74,74,74,74],
            [12,2,2,2,2,2,2,2,2],
            [90,90,91,92,92,92,92,92,92],
            [53,53,54,64,65,64,63,73,73],
            [54,64,63,73,73,73,73,73,73],
            [22,32,31,31,31,31,31,31,31],
            [67,68,58,48,38,38,38,38,38],
            [77,78,68,58,59,49,48,47,47],
            [32,32,31,31,31,31,31,31,31],
            [81,81,81,81,81,81,81,81,81],
            [10,10,10,10,10,10,10,10,10],
            [23,13,13,13,13,13,13,13,13],
            [58,48,38,38,38,38,38,38,38],
            [41,31,31,31,31,31,31,31,31],
            [15,25,25,25,25,25,25,25,25],
            [11,11,11,11,11,11,11,11,11],
            [63,63,62,62,61,71,81,81,81],
            [8,8,18,19,29,39,38,38,38],
            [57,47,47,47,47,47,47,47,47],
            [4,14,24,25,25,25,25,25,25],
            [73,73,73,73,73,73,73,73,73],
            [82,82,82,82,82,82,82,82,82],
            [51,51,61,71,72,82,82,82,82],
            [74,74,74,74,74,74,74,74,74],
            [62,61,60,70,80,81,81,81,81],
            [56,56,56,46,46,46,46,46,46],
            [79,69,59,49,48,38,38,38,38],
            [62,61,60,70,80,81,81,81,81],
            [78,77,87,86,76,75,74,74,74],
            [95,96,86,76,75,74,74,74,74],
            [27,37,37,37,37,37,37,37,37],
            [49,49,39,38,38,38,38,38,38],
            [55,45,45,45,45,45,45,45,45],
            [23,13,13,13,13,13,13,13,13],
            [75,74,74,74,74,74,74,74,74],
            [96,86,85,84,84,84,84,84,84],
            [14,14,14,24,25,26,26,26,26],
            [89,79,69,69,59,58,48,47,47],
            [19,19,19,29,39,38,38,38,38],
            [86,86,87,77,76,75,74,74,74],
            [21,21,11,11,11,11,11,11,11],
            [85,85,84,84,84,84,84,84,84],
            [61,61,62,61,60,70,80,70,80],
            [73,73,73,73,73,73,73,73,73],
            [90,91,92,92,92,92,92,92,92],
            [53,52,51,61,62,61,60,70,71],
            [82,82,82,82,82,82,82,82,82],
            [14,14,14,24,25,25,25,25,25],
            [31,31,31,31,31,31,31,31,31],
            [49,39,38,38,38,38,38,38,38],
            [9,9,19,29,39,38,38,38,38],
            [49,49,39,38,38,38,38,38,38],
            [5,5,15,25,25,25,25,25,25],
            [71,81,81,81,81,81,81,81,81],
            [67,68,58,48,38,38,38,38,38],
            [89,79,69,59,59,49,39,38,38],
            [89,89,89,79,69,59,49,39,38],
            [52,52,52,51,41,31,31,31,31],
            [35,35,35,35,35,35,35,35,35],
            [16,26,26,26,26,26,26,26,26],
            [7,7,8,18,28,38,38,38,38],
            [82,82,82,82,82,82,82,82,82],
            [31,31,31,31,31,31,31,31,31],
            [1,1,1,1,1,1,1,1,1],
            [24,34,34,34,34,34,34,34,34],
            [85,75,74,74,74,74,74,74,74],
            [11,11,11,11,11,11,11,11,11],
            [52,42,41,31,31,31,31,31,31],
            [7,8,18,28,38,38,38,38,38],
            [83,83,83,83,83,83,83,83,83],
            [17,18,19,29,39,38,38,38,38],
            [0,0,0,0,0,0,0,0,0],
            [22,32,33,34,34,34,34,34,34],
            [68,58,48,38,38,38,38,38,38],
            [54,54,64,74,74,74,74,74,74],
            [15,25,25,25,25,25,25,25,25],
            [70,70,80,90,91,81,81,81,81],
            [50,40,41,31,31,31,31,31,31],
            [63,64,74,74,74,74,74,74,74],
            [38,38,38,38,38,38,38,38,38],
            [88,78,68,58,48,38,38,38,38],
            [23,23,13,13,13,13,13,13,13],
            [8,9,19,29,39,38,38,38,38],
            [52,42,43,44,34,34,34,34,34],
            [40,30,31,31,31,31,31,31,31],
            [96,96,86,76,75,74,74,74,74],
            [48,48,38,38,38,38,38,38,38],
            [54,54,44,34,34,34,34,34,34],
            [47,47,47,47,47,47,47,47,47],
            [25,25,25,25,25,25,25,25,25],
            [72,62,62,52,42,41,31,31,31],
            [98,98,88,78,68,58,48,47,47],
            [45,45,45,45,45,45,45,45,45],
            [51,41,40,40,30,31,31,31,31],
            [44,44,44,34,34,34,34,34,34],
            [36,36,36,36,36,36,36,36,36],
            [64,54,44,43,43,44,34,34,34],
            [35,35,35,35,35,35,35,35,35],
            [70,70,80,81,81,81,81,81,81],
            [6,5,4,3,13,13,13,13,13],
            [7,7,7,6,5,4,3,2,2],
            [35,35,35,35,35,35,35,35,35],
            [67,57,47,47,47,47,47,47,47],
            [72,72,82,82,82,82,82,82,82],
            [80,81,81,81,81,81,81,81,81],
            [22,23,24,25,25,25,25,25,25],
            [69,59,49,48,38,38,38,38,38],
            [48,38,38,38,38,38,38,38,38],
            [56,46,46,46,46,46,46,46,46],
            [39,38,38,38,38,38,38,38,38],
            [32,42,43,44,34,34,34,34,34],
            [58,58,48,38,38,38,38,38,38],
            [6,6,6,5,4,3,3,3,13],
            [8,8,8,9,19,18,19,29,39],
            [72,82,82,82,82,82,82,82,82],
            [38,38,38,38,38,38,38,38,38],
            [68,68,58,59,49,48,38,38,38],
            [4,4,3,2,2,2,2,2,2],
            [18,18,19,18,17,18,19,29,39],
            [68,58,48,38,39,39,38,38,38],
            [6,6,5,4,3,2,2,2,2],
            [91,92,92,92,92,92,92,92,92],
            [86,86,76,75,74,74,74,74,74],
            [36,36,36,36,36,36,36,36,36],
            [54,44,45,45,45,45,45,45,45],
            [51,51,41,31,31,31,31,31,31],
            [9,9,19,29,39,38,38,38,38],
            [54,54,44,45,45,45,45,45,45],
            [78,68,58,48,38,38,38,38,38],
            [15,15,25,25,25,25,25,25,25],
            [4,4,3,2,2,2,2,2,2],
            [99,89,79,69,69,69,59,49,39],
            [71,81,81,81,81,81,81,81,81],
            [42,42,41,31,31,31,31,31,31],
            [83,83,83,83,83,83,83,83,83],
            [9,19,29,39,49,39,38,38,38],
            [94,93,93,93,93,93,93,93,93],
            [96,97,87,77,67,57,47,47,47],
            [44,34,34,34,34,34,34,34,34],
            [31,31,31,31,31,31,31,31,31],
            [15,25,25,25,25,25,25,25,25],
            [95,96,96,97,87,77,76,75,74],
            [6,6,5,4,3,2,2,2,2],
            [16,26,26,26,26,26,26,26,26],
            [3,2,2,2,2,2,2,2,2],
            [3,13,13,13,13,13,13,13,13],
            [26,26,26,26,26,26,26,26,26],
            [11,11,11,11,11,11,11,11,11],
            [88,78,68,58,48,38,38,38,38],
            [43,43,33,34,34,34,34,34,34],
            [54,55,45,46,46,46,46,46,46],
            [34,34,34,34,34,34,34,34,34],
            [54,44,34,34,34,34,34,34,34],
            [87,77,67,57,47,37,37,37,37],
            [75,75,65,55,45,45,45,45,45],
            [29,29,39,38,38,38,38,38,38],
            [23,23,24,25,25,25,25,25,25],
            [17,17,17,18,19,29,39,38,38],
            [86,86,86,87,77,78,68,58,48],
            [53,43,44,45,35,35,35,35,35],
            [98,88,78,68,58,48,47,47,47],
            [23,23,23,33,34,34,34,34,34],
            [24,24,25,25,25,25,25,25,25],
            [2,2,2,2,2,2,2,2,2],
            [11,11,11,11,11,11,11,11,11],
            [14,13,13,13,13,13,13,13,13],
            [95,95,95,96,97,98,97,87,77],
            [65,64,74,74,74,74,74,74,74],
            [89,79,69,59,49,59,49,39,38],
            [83,83,83,83,83,83,83,83,83],
            [78,78,79,69,59,49,49,48,38],
            [5,5,5,5,15,25,25,25,25],
            [34,34,34,34,34,34,34,34,34],
            [90,90,91,91,92,93,93,93,93],
            [71,71,81,81,81,81,81,81,81],
            [75,75,74,74,74,74,74,74,74],
            [43,43,44,54,44,34,34,34,34],
            [41,41,41,41,31,31,31,31,31],
            [68,68,68,58,48,38,38,38,38],
            [12,12,12,13,13,13,13,13,13],
            [58,58,58,48,38,38,38,38,38],
            [29,29,39,38,38,38,38,38,38],
            [57,57,47,47,47,47,47,47,47],
            [81,81,81,81,81,81,81,81,81],
            [98,88,78,68,67,57,47,47,47],
            [56,56,46,46,46,46,46,46,46],
            [1,1,1,1,1,1,1,1,1],
            [77,78,68,69,59,58,59,49,39],
            [92,92,92,92,92,92,92,92,92],
            [83,83,83,83,83,83,83,83,83],
            [33,34,34,34,34,34,34,34,34],
            [73,73,73,73,73,73,73,73,73],
            [63,73,73,73,73,73,73,73,73],
            [77,67,57,47,47,47,47,47,47],
            [64,54,44,34,34,34,34,34,34],
            [15,25,25,25,25,25,25,25,25],
            [72,72,82,82,82,82,82,82,82],
            [56,56,46,46,46,46,46,46,46],
            [53,43,33,34,34,34,34,34,34],
            [65,65,55,45,45,45,45,45,45],
            [89,89,79,69,59,49,39,38,38],
            [4,4,14,24,34,34,34,34,34],
            [19,19,19,29,39,38,38,38,38],
            [47,47,47,47,47,47,47,47,47],
            [19,18,28,38,38,38,38,38,38],
            [52,52,53,54,55,45,45,45,45],
            [56,56,46,46,46,46,46,46,46],
            [81,81,81,81,81,81,81,81,81],
            [97,87,77,67,57,47,47,47,47],
            [93,93,93,83,93,93,93,93,93],
            [85,85,84,84,84,84,84,84,84],
            [28,28,27,27,37,37,37,37,37],
            [58,58,48,38,38,38,38,38,38],
            [41,31,31,31,31,31,31,31,31],
            [52,52,42,41,31,31,31,31,31],
            [63,73,73,73,73,73,73,73,73],
            [70,80,90,90,80,81,81,81,81],
            [41,31,31,31,31,31,31,31,31],
            [64,74,74,74,74,74,74,74,74],
            [0,0,0,0,0,0,0,0,0],
            [12,2,2,2,2,2,2,2,2],
            [76,75,74,74,74,74,74,74,74],
            [37,37,37,37,37,37,37,37,37],
            [95,96,86,76,75,74,74,74,74],
            [47,47,47,47,47,47,47,47,47],
            [96,86,76,75,74,74,74,74,74],
            [9,9,19,29,39,38,38,38,38],
            [44,44,34,34,34,34,34,34,34],
            [31,31,31,31,31,31,31,31,31],
            [67,67,57,47,47,47,47,47,47],
            [64,64,65,55,45,45,45,45,45],
            [4,4,14,24,34,34,34,34,34],
            [63,62,61,71,81,81,81,81,81],
            [7,7,7,6,5,4,3,2,2],
            [73,73,73,73,73,73,73,73,73],
            [20,20,20,20,20,20,20,20,20],
            [37,37,37,37,37,37,37,37,37],
            [91,91,91,92,92,92,92,92,92],
            [56,56,56,55,45,35,35,35,35],
            [21,21,11,1,1,1,1,1,1],
            [36,36,36,36,36,36,36,36,36],
            [12,12,2,2,2,2,2,2,2],
            [50,50,40,30,20,20,20,20,20],
            [80,81,81,81,81,81,81,81,81],
            [51,51,61,71,81,81,81,81,81],
            [9,9,19,29,39,38,38,38,38],
            [44,54,44,43,44,45,46,46,46],
            [71,71,81,81,81,81,81,81,81],
            [26,26,26,26,26,26,26,26,26],
            [25,25,25,25,25,25,25,25,25],
            [85,85,84,84,84,84,84,84,84],
            [57,57,56,46,46,46,46,46,46],
            [33,34,34,34,34,34,34,34,34],
            [70,80,81,81,81,81,81,81,81],
            [53,53,54,44,45,45,45,45,45],
            [21,21,20,20,20,20,20,20,20],
            [59,49,48,47,47,47,47,47,47],
            ########################################Gaurish ends ######################################
            
            ########################################Anirban Starts ######################################
            [22,32,31,31,31,31,31,31,31],
            [60,60,70,80,90,91,81,81,81],
            [16,16,26,26,26,26,26,26,26],
            [14,24,34,34,34,34,34,34,34],
            [96,86,76,77,78,68,58,48,38],
            [39,39,39,39,49,48,47,46,46],
            [89,89,79,69,69,59,49,48,58],
            [53,43,44,45,35,25,25,25,25],
            [20,20,20,20,20,20,20,20,20],
            [30,31,31,31,31,31,31,31,31],
            [52,42,41,42,32,33,34,34,34],
            [40,40,41,42,43,44,45,35,35],
            [66,66,65,55,45,35,36,36,36],
            [69,59,49,39,38,37,36,35,25],
            [20,20,10,11,12,13,13,13,13],
            [17,18,19,19,29,39,49,48,38],
            [9,8,7,6,5,4,3,2,1],
            [36,36,36,36,36,36,36,36,36],
            [93,92,92,92,92,92,92,92,92],
            [6,6,5,15,14,24,34,34,34],
            [20,20,20,20,30,31,31,31,31],
            [60,60,70,80,81,82,82,82,92],
            [11,11,11,1,1,1,1,1,1],
            [7,7,8,9,19,29,39,39,38],
            [96,96,86,87,77,87,86,76,75],
            [25,25,25,25,35,45,45,45,45],
            [74,74,73,73,73,73,73,73,73],
            [37,37,36,35,34,34,34,34,34],
            [57,57,47,46,36,35,34,34,34],
            [37,37,37,37,37,37,37,37,37],
            [96,86,76,66,65,64,74,84,83],
            [17,17,16,16,16,15,16,6,5],
            [55,65,55,56,46,36,36,36,36],
            [31,31,31,31,31,31,31,31,31],
            [63,73,73,73,73,73,73,73,73],
            [9,9,8,18,28,38,38,38,38],
            [70,70,80,81,81,81,81,81,81],
            [48,48,47,47,47,47,47,47,47],
            [55,55,45,45,45,45,45,45,45],
            [73,73,73,73,73,73,73,73,73],
            [60,50,50,40,40,30,31,31,31],
            [50,50,50,60,70,80,90,91,81],
            [81,81,81,82,82,82,82,82,82],
            [18,18,28,38,38,38,38,38,38],
            [73,73,73,73,73,73,73,73,73],
            [73,73,73,73,73,73,73,73,73],
            [12,12,12,13,13,13,13,13,13],
            [38,38,37,37,37,37,37,37,37],
            [39,38,38,38,38,38,38,38,38],
            [92,92,92,92,92,92,92,92,92],
            [58,57,47,47,47,47,47,47,47],
            [20,30,31,31,31,31,31,31,31],
            [91,81,81,81,81,81,81,81,81],
            [53,53,54,44,34,34,34,34,34],
            [50,50,40,40,30,20,20,20,20],
            [83,83,83,83,83,83,83,83,83],
            [75,75,65,66,56,46,46,46,46],
            [71,71,81,82,82,82,82,82,82],
            [12,12,13,13,13,13,13,13,13],
            [35,35,35,35,35,35,35,35,35],
            [86,76,66,65,64,65,75,74,74],
            [87,87,87,77,67,57,58,48,47],
            [58,58,48,47,47,47,47,47,47],
            [2,1,1,1,1,1,1,1,1],
            [54,44,45,45,45,45,45,45,45],
            [62,62,63,53,43,44,34,34,34],
            [23,23,33,34,34,34,34,34,34],
            [15,15,25,25,25,25,25,25,25],
            [19,19,19,19,29,39,38,38,38],
            [31,31,31,31,31,31,31,31,31],
            [48,48,47,47,47,47,47,47,47],
            [43,53,54,44,45,45,45,45,45],
            [81,81,81,81,81,81,81,81,81],
            [66,66,76,75,74,74,74,74,74],
            [4,4,4,4,14,13,13,13,13],
            [84,84,84,84,84,84,84,84,84],
            [90,80,81,81,81,81,81,81,81],
            [48,47,47,47,47,47,47,47,47],
            [51,52,42,32,31,31,31,31,31],
            [46,46,46,46,46,46,46,46,46],
            [47,47,47,47,47,47,47,47,47],
            [43,43,44,34,34,34,34,34,34],
            [75,75,75,75,65,55,45,45,45],
            [74,74,74,74,74,74,74,74,74],
            [83,83,83,83,83,83,83,83,83],
            [85,85,84,84,84,84,84,84,84],
            [13,13,13,13,13,13,13,13,13],
            [58,58,48,47,47,47,47,47,47],
            [81,81,81,81,81,81,81,81,81],
            [70,80,81,81,81,81,81,81,81],
            [15,15,25,25,25,25,25,25,25],
            [43,33,34,34,34,34,34,34,34],
            [89,89,79,69,59,49,48,47,47],
            [51,51,41,42,32,31,31,31,31],
            [65,65,75,74,74,74,74,74,74],
            [59,59,49,48,47,47,47,47,47],
            [86,86,76,75,74,74,74,74,74],
            [18,28,38,38,38,38,38,38,38],
            [17,18,19,29,39,38,38,38,38],
            [3,3,13,13,13,13,13,13,13],
            [21,21,20,20,20,20,20,20,20],
            [38,38,38,38,38,38,38,38,38],
            [83,83,83,83,83,83,83,83,83],
            [21,21,20,20,20,20,20,20,20],
            [34,34,34,34,34,34,34,34,34],
            [37,37,37,37,37,37,37,37,37],
            [79,79,69,59,49,48,47,47,47],
            [31,31,31,31,31,31,31,31,31],
            [27,27,26,26,26,26,26,26,26],
            [27,26,26,26,26,26,26,26,26],
            [82,82,82,82,82,82,82,82,82],
            [97,97,87,77,76,75,74,74,74],
            [70,70,80,90,90,91,92,92,92],
            [15,15,25,25,25,25,25,25,25],
            [57,57,47,47,47,47,47,47,47],
            [89,89,79,78,77,76,75,74,74],
            [77,77,77,76,75,74,74,74,74],
            [92,92,82,82,82,82,82,82,82],
            [19,19,29,28,38,38,38,38,38],
            [73,73,73,73,73,73,73,73,73],
            [59,59,49,59,58,48,58,57,47],
            [74,74,74,74,74,74,74,74,74],
            [85,85,84,84,84,84,84,84,84],
            [99,99,89,79,69,59,58,48,38],
            [23,23,23,33,34,34,34,34,34],
            [75,75,74,74,74,74,74,74,74],
            [25,25,25,25,25,25,25,25,25],
            [71,71,81,81,81,81,81,81,81],
            [4,4,14,13,13,13,13,13,13],
            [93,93,93,93,93,93,93,93,93],
            [5,5,15,14,24,25,25,25,25],
            [52,42,32,31,31,31,31,31,31],
            [18,28,38,38,38,38,38,38,38],
            [41,41,31,31,31,31,31,31,31],
            [30,30,31,31,31,31,31,31,31],
            [5,5,5,15,25,25,25,25,25],
            [78,78,68,58,48,38,38,38,38],
            [46,46,46,46,46,46,46,46,46],
            [73,73,73,73,73,73,73,73,73],
            [70,70,80,81,81,81,81,81,81],
            [83,83,83,83,83,83,83,83,83],
            [70,70,80,90,91,81,71,81,81],
            [13,13,13,13,13,13,13,13,13],
            [83,83,83,83,83,83,83,83,83],
            [50,50,40,40,30,31,31,31,31],
            [52,52,42,41,42,43,44,45,45],
            [47,47,47,47,47,47,47,47,47],
            [5,5,15,25,25,25,25,25,25],
            [34,34,34,34,34,34,34,34,34],
            [81,81,81,81,81,81,81,81,81],
            [50,50,50,40,30,31,31,31,31],
            [6,6,6,6,6,6,6,5,4],
            [36,36,36,36,36,36,36,36,36],
            [76,76,75,74,74,74,74,74,74],
            [23,23,13,13,13,13,13,13,13],
            [51,51,41,31,31,31,31,31,31],
            [50,50,50,40,30,20,10,10,10],
            [44,34,34,34,34,34,34,34,34],
            [94,94,94,93,93,93,93,93,93],
            [0,0,0,10,10,10,10,10,10],
            [40,40,30,20,20,20,20,20,20],
            [60,60,50,40,30,20,20,20,20],
            [60,60,60,50,40,30,20,20,20],
            [62,62,52,42,32,33,34,34,34],
            [50,50,40,30,20,10,11,11,11],
            [23,23,13,3,3,3,13,13,13],
            [64,64,54,44,34,34,34,34,34],
            [79,79,79,69,59,49,48,47,47],
            [27,27,27,37,37,37,37,37,37],
            [7,7,17,18,28,38,38,38,38],
            [99,99,89,79,69,59,58,48,38],
            [47,47,47,47,47,47,47,47,47],
            [60,60,70,80,81,81,81,81,81],
            [56,56,46,46,46,46,46,46,46],
            [99,99,89,79,69,59,58,48,38],
            [10,10,10,10,10,10,10,10,10],
            [12,12,2,1,1,1,1,1,1],
            [51,51,41,31,31,31,31,31,31],
            [4,4,14,13,13,13,13,13,13],
            [60,60,60,50,40,30,20,20,20],
            [65,65,55,45,45,45,45,45,45],
            [50,50,40,30,31,31,31,31,31],
            [35,35,35,35,35,35,35,35,35],
            [5,5,5,15,25,25,25,25,25],
            [58,58,48,38,38,38,38,38,38],
            [79,79,69,59,49,39,38,38,38],
            [42,42,32,33,34,34,34,34,34],
            [41,41,31,31,31,31,31,31,31],
            [82,82,82,82,82,82,82,82,82],
            [35,35,35,35,35,35,35,35,35],
            [73,73,73,73,73,73,73,73,73],
            [66,66,76,75,74,74,74,74,74],
            [52,52,42,32,31,31,31,31,31],
            [37,37,37,37,37,37,37,37,37],
            [25,25,25,25,25,25,25,25,25],
            [94,94,94,94,93,93,93,93,93],
            [86,86,76,75,74,74,74,74,74],
            [5,5,15,25,25,25,25,25,25],
            [8,8,8,8,18,19,29,39,38],
            [15,15,15,15,25,25,25,25,25],
            [75,75,74,74,74,74,74,74,74],
            [75,75,74,74,74,74,74,74,74],
            [49,49,48,47,47,47,47,47,47],
            [49,49,48,47,47,47,47,47,47],
            [45,45,45,45,45,45,45,45,45],
            [72,72,82,82,82,82,82,82,82],
            [33,33,34,34,34,34,34,34,34],
            [62,62,61,71,81,81,81,81,81],
            [90,90,80,81,81,81,81,81,81],
            [13,13,13,13,13,13,13,13,13],
            [47,47,47,47,47,47,47,47,47],
            [76,76,75,74,74,74,74,74,74],
            [43,43,33,34,34,34,34,34,34],
            [92,92,92,92,92,92,92,92,92],
            [63,73,73,73,73,73,73,73,73],
            [12,13,13,13,13,13,13,13,13],
            [22,22,23,24,25,25,25,25,25],
            [48,49,49,48,38,28,38,38,38],
            [8,18,28,27,28,29,39,38,38],
            [89,89,79,78,77,76,75,74,74],
            [95,95,96,97,87,77,87,86,76],
            [80,80,81,81,81,81,81,81,81],
            [29,29,39,38,38,38,38,38,38],
            [34,34,34,34,34,34,34,34,34],
            [89,89,88,78,68,58,48,38,38],
            [22,22,23,24,14,13,13,13,13],
            
            [63,73,73,73,73,73,73,73,73],
            [6,6,5,4,14,13,13,13,13],
            [67,67,57,47,47,47,47,47,47],
            [52,52,51,61,71,81,81,81,81],
            [47,47,47,47,47,47,47,47,47],
            [72,72,82,82,82,82,82,82,82],
            [59,59,49,39,38,38,38,38,38],
            [35,35,35,35,35,35,35,35,35],
            [20,20,20,20,20,20,20,20,20],
            [92,92,92,92,92,92,92,92,92],
            [99,99,89,79,79,69,59,58,48],
            [18,17,18,28,38,48,48,48,38],
            [99,99,89,79,78,77,76,75,74],
            [98,98,97,87,77,67,57,47,47],
            [75,75,75,74,74,74,74,74,74],
            [5,5,5,15,25,25,25,25,25],
            [8,8,18,28,38,38,38,38,38],
            [45,45,45,45,45,45,45,45,45],
            [79,79,79,69,59,49,48,47,47],
            [0,0,10,10,10,10,10,10,10],
            [7,7,6,5,4,14,24,23,13],
            [45,45,45,45,45,45,45,45,45],
            [55,55,45,45,45,45,45,45,45],
            [89,89,79,69,59,58,48,38,38],
            [12,12,13,13,13,13,13,13,13],
            [27,27,37,37,37,37,37,37,37],
            [24,34,34,34,34,34,34,34,34],
            [54,54,44,34,34,34,34,34,34],
            [86,76,66,65,66,65,75,74,74],
            [98,98,99,89,79,69,59,49,48],
            [13,14,24,34,34,34,34,34,34],
            [3,3,13,13,13,13,13,13,13],
            [93,93,83,83,83,83,83,83,83],
            [68,68,58,48,38,38,38,38,38],
            [56,56,46,46,46,46,46,46,46],
            [58,58,57,47,47,47,47,47,47],
            [93,93,93,93,93,93,93,93,93],
            [36,36,36,36,36,36,36,36,36],
            [85,84,84,84,84,84,84,84,84],
            [2,1,1,1,1,1,1,1,1],
            [6,6,5,4,3,13,13,13,13],
            [42,42,32,42,42,41,31,31,31],
            [61,71,81,81,81,81,81,81,81],
            [95,96,97,87,77,67,66,65,64],
            [13,13,13,13,13,13,13,13,13],
            [18,18,28,38,38,38,38,38,38],
            [96,96,86,87,77,76,86,85,75],
            [10,10,10,10,10,10,10,10,10],
            [7,17,18,28,38,38,38,38,38],
            [84,84,84,84,84,84,84,84,84],
            [16,16,15,25,25,25,25,25,25],
            [55,55,54,44,34,34,34,34,34],
            [75,75,74,74,74,74,74,74,74],
            [64,74,74,74,74,74,74,74,74],
            [8,8,18,28,29,39,38,38,38],
            [66,66,67,68,58,48,38,38,38],
            [4,4,14,13,13,13,13,13,13],
            [44,44,34,34,34,34,34,34,34],
            [46,46,46,46,46,46,46,46,46],
            [85,85,84,84,84,84,84,84,84],
            [63,73,73,73,73,73,73,73,73],
            [15,15,25,25,25,25,25,25,25],
            [1,1,1,1,1,1,1,1,1],
            [44,44,45,45,45,45,45,45,45],
            [6,6,5,15,25,25,25,25,25],
            [10,10,10,10,10,10,10,10,10],
            [23,23,24,34,34,34,34,34,34],
            [69,69,69,69,59,49,48,38,38],
            [82,82,82,82,82,82,82,82,82],
            [44,44,45,45,45,45,45,45,45],
            [48,48,47,47,47,47,47,47,47],
            [17,17,18,28,38,38,38,38,38],
            [59,49,48,38,38,38,38,38,38],
            [74,74,74,74,74,74,74,74,74],
            [5,5,15,25,25,25,25,25,25],
            [79,79,69,68,58,48,38,38,38],
            [57,57,57,57,58,58,48,47,47],
            [89,89,79,69,59,58,48,38,38],
            [79,79,69,59,69,68,58,48,47],
            [36,36,36,36,36,36,36,36,36],
            [89,89,88,78,68,58,48,38,38],
            [62,62,61,60,70,71,81,81,81],
            [68,68,58,48,47,47,47,47,47],
            [10,10,10,10,10,10,10,10,10],
            [96,96,86,76,86,85,84,84,84],
            [27,27,37,37,37,37,37,37,37],
            [28,38,38,38,38,38,38,38,38],
            [24,24,34,34,34,34,34,34,34],
            [37,37,37,37,37,37,37,37,37],
            [39,39,38,38,38,38,38,38,38],
            [76,76,77,78,68,67,57,47,47],
            [30,30,31,31,31,31,31,31,31],
            [96,96,95,85,84,84,84,84,84],
            [15,15,25,25,25,25,25,25,25],
            [98,98,88,78,68,58,48,38,38],
            [62,62,62,61,60,70,70,80,81],
            [16,16,16,16,26,26,26,26,26],
            [70,70,71,61,51,41,31,31,31],
            [94,94,93,93,93,93,93,93,93],
            [96,96,86,76,75,74,74,74,74],
            [33,33,32,31,31,31,31,31,31],
            [80,80,81,81,81,81,81,81,81],
            [85,85,84,84,84,84,84,84,84],
            [10,10,10,10,10,10,10,10,10],
            [78,78,78,68,58,48,38,38,38],
            [83,83,83,83,83,83,83,83,83],
            [33,33,32,31,31,31,31,31,31],
            [64,74,74,74,74,74,74,74,74],
            [85,85,84,84,84,84,84,84,84],
            [34,34,34,34,34,34,34,34,34],
            [19,29,39,38,38,38,38,38,38],
            [70,80,81,81,81,81,81,81,81],
            [73,73,73,73,73,73,73,73,73],
            [72,82,82,82,82,82,82,82,82],
            [51,61,71,71,81,81,81,81,81],
            [54,54,64,74,74,74,74,74,74],
            [64,64,74,74,74,74,74,74,74],
            [13,13,13,13,13,13,13,13,13],
            [1,1,1,1,1,1,1,1,1],
            [49,49,39,38,38,38,38,38,38],
            [1,1,1,1,1,1,1,1,1],
            [39,39,38,38,38,38,38,38,38],
            [6,6,5,15,14,13,13,13,13],
            [0,0,1,1,1,1,1,1,1],
            [86,86,76,75,74,74,74,74,74],
            [33,33,34,34,34,34,34,34,34],
            [70,70,70,80,81,81,81,81,81],
            [87,87,86,76,75,74,74,74,74],
            [50,50,40,30,31,31,31,31,31],
            [54,44,45,45,45,45,45,45,45],
            [73,73,73,73,73,73,73,73,73],
            [12,12,13,13,13,13,13,13,13],
            [26,26,26,26,26,26,26,26,26],
            [26,26,26,26,26,26,26,26,26],
            [40,40,40,41,31,31,31,31,31],
            [96,96,86,76,66,67,68,69,59],
            [56,46,46,46,46,46,46,46,46],
            [54,54,44,34,34,34,34,34,34],
            [23,23,33,34,34,34,34,34,34],
            [26,26,26,26,26,26,26,26,26],
        ]
        trajectories = []
        n_trajectories=len(traj)
        for i in range(n_trajectories):
            trajectory = []
            #for j in range(trajectory_length):
            for j in range(len(traj[i])):
                trajectory.append((traj[i][j], 0, 0))
            
            trajectories.append(trajectory)
        return np.array(trajectories)
    '''
    def feature_matrix_3C3O(self):
        features = [[5,5,8],[4,4,7],[3,3,6],[4,2,5],[5,3,4],[6,4,5],
                    [4,4,7],[3,3,6],[2,2,5],[3,1,4],[4,2,3],[5,3,4],
                    [3,3,6],[2,2,5],[1,1,4],[2,0,3],[3,1,2],[4,2,3],
                    [2,4,5],[1,3,4],[0,2,3],[1,1,2],[2,2,1],[3,3,2],
                    [3,5,4],[2,4,3],[1,3,2],[2,2,1],[3,3,0],[4,4,1],
                    [4,6,5],[3,5,4],[2,4,3],[3,3,2],[4,4,1],[5,5,2]]
        return np.array(features)
    
    def feature_matrix_3C3ODummy(self):
        features = [[0,0,0,0],[0,0,0,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],
                    [0,0,0,1],[0,0,0,1],[1,0,0,1],[0,1,0,0],[0,0,0,0],[0,0,0,0],
                    [0,0,0,0],[1,0,0,1],[1,1,0,0],[1,1,0,0],[0,1,0,0],[0,0,0,0],
                    [1,0,0,0],[1,0,0,0],[1,0,0,0],[1,1,0,0],[1,0,1,0],[0,0,0,0],
                    [0,0,0,0],[1,0,0,0],[1,0,0,0],[1,0,1,0],[0,0,1,0],[0,0,1,0],
                    [0,0,0,0],[0,0,0,0],[1,0,0,0],[0,0,0,0],[0,0,1,0],[0,0,0,0]]
        
        return np.array(features)
    '''
    def feature_matrix_manhatten_distance(self):
        features = [
                    [2,4,6] , [1,3,5] , [2,2,4] , [3,3,3] , [4,4,4] , [4,3,5] , [3,2,6] , [4,1,5] , [5,2,4] , [6,3,5] ,
                    [1,3,5] , [0,2,4] , [1,1,3] , [2,2,2] , [3,3,3] , [3,2,4] , [2,1,5] , [3,0,4] , [4,1,3] , [5,2,4] ,
                    [2,2,4] , [1,1,3] , [2,0,2] , [3,1,1] , [3,2,2] , [2,3,3] , [1,2,4] , [2,1,3] , [3,2,2] , [4,3,3] ,
                    [3,3,3] , [2,2,2] , [3,1,1] , [3,2,0] , [2,3,1] , [1,4,2] , [0,3,3] , [1,2,2] , [2,3,1] , [3,4,2] ,
                    [4,4,4] , [3,3,3] , [4,2,2] , [4,3,1] , [3,4,2] , [2,3,3] , [1,2,2] , [2,3,1] , [3,4,0] , [4,5,1] ,
                    [5,3,5] , [4,2,4] , [4,1,3] , [3,2,2] , [4,3,3] , [3,2,4] , [2,1,3] , [3,2,2] , [4,3,1] , [5,4,2] ,
                    [5,2,6] , [4,1,5] , [3,0,4] , [2,1,3] , [3,2,4] , [4,1,5] , [3,0,4] , [4,1,3] , [5,2,2] , [6,3,3] ,
                    [4,3,7] , [3,2,6] , [2,1,5] , [1,2,4] , [2,3,5] , [3,2,6] , [4,1,5] , [5,2,4] , [6,3,3] , [7,4,4] ,
                    [3,4,8] , [2,3,7] , [1,2,6] , [0,3,5] , [1,2,6] , [2,1,7] , [3,2,6] , [4,3,5] , [5,4,4] , [6,5,5] ,
                    [4,5,9] , [3,4,8] , [2,3,7] , [1,2,6] , [2,1,7] , [3,0,8] , [4,1,7] , [5,2,6] , [6,3,5] , [7,4,6] 
                   ]

        return np.array(features)
    
    def feature_matrix_effect_range(self):
        features = [
                    [1,0,0] , [1,0,0] , [1,0,0] , [0,0,0] , [0,0,0] , [0,0,0] , [0,0,0] , [0,1,0] , [0,0,0] , [0,0,0] ,
                    [1,0,0] , [1,0,0] , [1,1,0] , [1,0,0] , [0,0,0] , [0,0,0] , [1,1,0] , [0,1,0] , [0,1,0] , [0,0,0] ,
                    [1,0,0] , [1,1,0] , [1,1,0] , [0,1,1] , [0,0,0] , [1,0,0] , [1,0,0] , [1,1,0] , [0,0,0] , [0,0,0] ,
                    [0,0,0] , [1,0,0] , [0,1,1] , [0,0,1] , [1,0,1] , [1,0,0] , [1,0,0] , [1,0,0] , [1,0,1] , [0,0,0] ,
                    [0,0,0] , [0,0,0] , [0,0,0] , [0,0,1] , [0,0,0] , [1,0,0] , [1,0,0] , [1,0,1] , [0,0,1] , [0,0,1] ,
                    [0,0,0] , [0,0,0] , [0,1,0] , [0,0,0] , [0,0,0] , [0,0,0] , [1,1,0] , [0,0,0] , [0,0,1] , [0,0,0] ,
                    [0,0,0] , [0,1,0] , [0,1,0] , [1,1,0] , [0,0,0] , [0,1,0] , [0,1,0] , [0,1,0] , [0,0,0] , [0,0,0] ,
                    [0,0,0] , [0,0,0] , [1,1,0] , [1,0,0] , [1,0,0] , [0,0,0] , [0,1,0] , [0,0,0] , [0,0,0] , [0,0,0] ,
                    [0,0,0] , [1,0,0] , [1,0,0] , [1,0,0] , [1,0,0] , [1,1,0] , [0,0,0] , [0,0,0] , [0,0,0] , [0,0,0] ,
                    [0,0,0] , [0,0,0] , [1,0,0] , [1,0,0] , [1,1,0] , [0,1,0] , [0,1,0] , [0,0,0] , [0,0,0] , [0,0,0] 
                   ]
        
        return np.array(features)